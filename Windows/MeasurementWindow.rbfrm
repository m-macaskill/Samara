#tag WindowBegin Window MeasurementWindow   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   False   Compatibility   =   ""   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   650   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "Saccade measurements"   Visible         =   False   Width           =   640   Begin PushButton acceptPushButton      AutoDeactivate  =   True      BehaviorIndex   =   0      Bold            =   False      Cancel          =   False      Caption         =   "Accept"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   "Add this measurement to the list and move on to the next saccade."      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   540      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   610      Underline       =   False      Visible         =   True      Width           =   80   End   Begin ComboBox TrialTypeComboBox      AutoComplete    =   False      AutoDeactivate  =   True      BehaviorIndex   =   1      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   21      HelpTag         =   "A description of the overall trial type for the set."      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "\rIPS\rGPS\rDPS\rIAS\rGAS\rDAS"      Italic          =   False      Left            =   443      ListIndex       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   343      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   177   End   Begin ComboBox antiSaccadeErrorComboBox      AutoComplete    =   False      AutoDeactivate  =   True      BehaviorIndex   =   2      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   21      HelpTag         =   "A description of any error made in an anti-saccade task."      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "None\rTiming\rDirection\rTiming & direction\rTiming corrected\rDirection corrected\rTiming & direction corrected"      Italic          =   False      Left            =   443      ListIndex       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   310      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   177   End   Begin TextField commentField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BehaviorIndex   =   3      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   152      HelpTag         =   "Optional comment to describe this trial."      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   443      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   "False"      Password        =   False      ReadOnly        =   False      Scope           =   "0"      ScrollbarHorizontal=   "False"      ScrollbarVertical=   "True"      Styled          =   "False"      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextFont        =   "System"      TextSize        =   0.0      Top             =   376      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   177   End   Begin ListBox measureListBox      AutoDeactivate  =   True      AutoHideScrollbars=   True      BehaviorIndex   =   4      Bold            =   False      Border          =   True      ColumnCount     =   2      ColumnsResizable=   True      ColumnWidths    =   "50%"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   False      EnableDragReorder=   False      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   616      HelpTag         =   ""      Hierarchical    =   False      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   False      Scope           =   "0"      ScrollbarHorizontal=   True      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   10.0      Top             =   14      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   339      _ScrollOffset   =   0      _ScrollWidth    =   -1   End   Begin Label captionStaticText      AutoDeactivate  =   True      BehaviorIndex   =   5      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   23      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   False      Left            =   365      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   "0"      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Anti-saccade error:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   10.0      Top             =   311      Underline       =   False      Visible         =   True      Width           =   72   End   Begin Label captionStaticText      AutoDeactivate  =   True      BehaviorIndex   =   5      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   False      Left            =   359      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Trial type:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   10.0      Top             =   345      Underline       =   False      Visible         =   True      Width           =   72   End   Begin Label captionStaticText      AutoDeactivate  =   True      BehaviorIndex   =   5      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   False      Left            =   359      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Comment:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   10.0      Top             =   378      Underline       =   False      Visible         =   True      Width           =   72   End   Begin PushButton cancelPushButton      AutoDeactivate  =   True      BehaviorIndex   =   6      Bold            =   False      Cancel          =   True      Caption         =   "Cancel"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   "Don't store this saccade measurement."      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   443      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   610      Underline       =   False      Visible         =   True      Width           =   80   End   Begin CheckBox rememberLastCommentCheckBox      AutoDeactivate  =   True      BehaviorIndex   =   7      Bold            =   False      Caption         =   "Remember comment next time"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   33      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   443      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   "0"      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   540      Underline       =   False      Value           =   False      Visible         =   True      Width           =   177   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  // sometimes it is useful to have comments persist from one measurement to the next so the same comment doesn't need to be retyped each time.		  // often that will be annoying.  So now the user can control that behaviour via a checkBox, which defaults to FALSE:		  if not self.rememberLastCommentCheckBox.value then self.commentField.Text = ""		  		  // added to fix a bug in which the measurement window would not always respond to the 'enter' key to close and return control to the chartWindow:		  self.commentField.setFocus		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub displayStats(stats as dictionary, callingSession as iViewSession)		  // takes a dictionary of measured statistics from a saccade where the keys are strings like "Primary saccade onset"		  // and the values are the corresponding measures and sets it up so that it can be displayed to the user and approved or cancelled.		  dim i, j, measurements, rows as integer		  dim label as string		  dim list as listBox		  		  mParentSession = callingSession  // set this property so that other UI methods in this window class know which iViewSet instance to communicate back to		  		  list = self.measureListBox		  measurements = stats.count -1		  		  if not mHasBeenShownOnce then		    list.heading(0) = "Statistic"		    list.heading(1) = "Value"		    list.selectionType = listBox.SelectionMultiple		    		    // add the required number of rows to the listBox		    for i = 0 to measurements		      label = stats.key(i)		      // don't display those values which are able to be edited using comboBoxes or a field:		      if label <> "Timing error" and label <> "Directional error" and label <> "Comment" then		        list.addRow label		      end if		    next		    		    mHasBeenShownOnce = true		    		  end if		  		  // fill in the content		  rows = list.ListCount - 1		  for i = 0 to rows		    label = list.cell(i, 0)		    list.cell(i,1) = stats.value(label)		  next		  		  		  // store the stats as a property for access by other methods in this window		  mCurrentStats = stats		  		exception err		  gHandleException err, "displayStats method of measurementWindow."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub resetToDefaults()		  // resets the antisaccade popup button to the default or else its setting is remembered from one measurement to		  // the next.  Don't clear the comment field as it may be useful to keep the same text in there.		  		  self.antiSaccadeErrorComboBox.listIndex = 0		  		End Sub	#tag EndMethod	#tag Property, Flags = &h1		#tag Note			a property holding the current dictionary of saccade measurements sent from the iViewSet class.  This allows the			stats to be modified and returned to the sender if required.		#tag EndNote		Protected mCurrentStats As dictionary	#tag EndProperty	#tag Property, Flags = &h1		#tag Note			Used so that we only set the titles and number of rows in the listBox once.		#tag EndNote		Protected mHasBeenShownOnce As boolean = false	#tag EndProperty	#tag Property, Flags = &h1		#tag Note			a reference (sent in the displayStats method arguments) which allows this class a target to send back saccade measurements			to the current requesting set if required.		#tag EndNote		Protected mParentSession As iViewSession	#tag EndProperty#tag EndWindowCode#tag Events acceptPushButton	#tag Event		Sub Action()		  // amend the measured stats and send them back to the parent iViewSet instance.		  // change some values if their controls are visble and they have some value.		  		  if self.antiSaccadeErrorComboBox.visible then		    if self.antiSaccadeErrorComboBox.text <> "" then mCurrentStats.value("Antisaccade error") = self.antiSaccadeErrorComboBox.text		  end if		  		  if self.trialTypeComboBox.visible then		    if self.trialTypeComboBox.text <> "" then mCurrentStats.value("Trial type") = self.trialTypeComboBox.text		  end if		  		  mCurrentStats.value("Comment") = self.commentField.text		  		  // send the stats back		  mParentSession.storeMeasurement mCurrentStats		  mParentSession.detectNextSaccade  // try to detect the next saccade		  self.hide		  'self.hide		  		End Sub	#tag EndEvent#tag EndEvents#tag Events cancelPushButton	#tag Event		Sub Action()		  self.hide		End Sub	#tag EndEvent#tag EndEvents#tag ViewBehavior	#tag ViewProperty		Name="BackColor"		Visible=true		Group="Appearance"		InitialValue="&hFFFFFF"		Type="Color"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Backdrop"		Visible=true		Group="Appearance"		Type="Picture"		EditorType="Picture"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="CloseButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Composite"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Frame"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Document"			"1 - Movable Modal"			"2 - Modal Dialog"			"3 - Floating Window"			"4 - Plain Box"			"5 - Shadowed Box"			"6 - Rounded Window"			"7 - Global Floating Window"			"8 - Sheet Window"			"9 - Metal Window"			"10 - Drawer Window"			"11 - Modeless Dialog"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="FullScreen"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="HasBackColor"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Height"		Visible=true		Group="Position"		InitialValue="400"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="ImplicitInstance"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Interfaces"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="LiveResize"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MacProcID"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxHeight"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaximizeButton"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxWidth"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBar"		Visible=true		Group="Appearance"		Type="MenuBar"		EditorType="MenuBar"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBarVisible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinHeight"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinimizeButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinWidth"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Name"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Placement"		Visible=true		Group="Position"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Default"			"1 - Parent Window"			"2 - Main Screen"			"3 - Parent Window Screen"			"4 - Stagger"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="Resizeable"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Super"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Title"		Visible=true		Group="Appearance"		InitialValue="Untitled"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Visible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Width"		Visible=true		Group="Position"		InitialValue="600"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty#tag EndViewBehavior