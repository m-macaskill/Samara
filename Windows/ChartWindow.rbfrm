#tag WindowBegin Window ChartWindow   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   True   Compatibility   =   ""   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   True   Height          =   650   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   495015587   MenuBarVisible  =   True   MinHeight       =   650   MinimizeButton  =   True   MinWidth        =   800   Placement       =   0   Resizeable      =   True   Title           =   "Untitled"   Visible         =   True   Width           =   1024   Begin ChartCanvas ChartCanvas      AcceptFocus     =   True      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   600      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   251      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   13      Transparent     =   True      UseFocusRing    =   False      Visible         =   True      Width           =   753   End   Begin ChartCanvas thumbCanvas      AcceptFocus     =   True      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   164      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Top             =   438      Transparent     =   True      UseFocusRing    =   False      Visible         =   True      Width           =   219   End   Begin PopupMenu setSelectorPopup      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   "Switch from one set of data to another."      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   110      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   13      Underline       =   False      Visible         =   True      Width           =   129   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "Select set:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   14      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   80   End   Begin Slider zoomTimeAxisSlider      AutoDeactivate  =   True      Enabled         =   False      Height          =   25      HelpTag         =   "Change the duration of data displayed."      Index           =   -2147483648      InitialParent   =   ""      Left            =   110      LineStep        =   1      LiveScroll      =   False      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Maximum         =   12      Minimum         =   1      PageStep        =   1      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TickStyle       =   "0"      Top             =   78      Value           =   1      Visible         =   True      Width           =   129   End   Begin PopupMenu TestTypePopUp      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   "Specifies the sort of test this is for analysis purposes."      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   110      ListIndex       =   -2147483648      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   45      Underline       =   False      Visible         =   True      Width           =   129   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   6      TabPanelIndex   =   0      Text            =   "Test type:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   46      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   80   End   Begin Label cursorText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   100      HelpTag         =   "Information about the data at the current cursor locations."      Index           =   0      InitialParent   =   ""      Italic          =   False      Left            =   17      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   7      TabPanelIndex   =   0      Text            =   "STIMULUS #:"      TextAlign       =   2      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   326      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   94   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   4      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "Zoom level:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   78      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   80   End   Begin Label cursorText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   36      HelpTag         =   "Information about this particular set of data."      Index           =   2      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   9      TabPanelIndex   =   0      Text            =   "Set info."      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   280      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   219   End   Begin ProgressWheel progressWheel      AutoDeactivate  =   True      Enabled         =   False      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Top             =   612      Visible         =   False      Width           =   16   End   Begin Label cursorText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   28      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   False      Left            =   48      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   11      TabPanelIndex   =   0      Text            =   "Status: No data imported."      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   614      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   578   End   Begin Label cursorText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   100      HelpTag         =   "Information about the data at the current cursor locations."      Index           =   1      InitialParent   =   ""      Italic          =   False      Left            =   126      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   13      TabPanelIndex   =   0      Text            =   "Cursor info."      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   326      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   113   End   Begin TextField groupField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   79      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   212      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   73   End   Begin TextField sexField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   197      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   212      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   42   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   5      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   17      TabPanelIndex   =   0      Text            =   "Group:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   214      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   53   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   7      InitialParent   =   ""      Italic          =   False      Left            =   169      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   19      TabPanelIndex   =   0      Text            =   "Sex:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   214      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   31   End   Begin GroupBox analysisGroupBox      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Analysis:"      Enabled         =   False      Height          =   77      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   134      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   28      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   110      Underline       =   False      Visible         =   True      Width           =   105      Begin RadioButton SelectAnalysis         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Horizontal"         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   0         InitialParent   =   "analysisGroupBox"         Italic          =   False         Left            =   141         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   136         Underline       =   False         Value           =   True         Visible         =   True         Width           =   88      End      Begin RadioButton SelectAnalysis         AutoDeactivate  =   True         Bold            =   False         Caption         =   "2D"         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   1         InitialParent   =   "analysisGroupBox"         Italic          =   False         Left            =   141         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   160         Underline       =   False         Value           =   False         Visible         =   True         Width           =   50      End   End   Begin GroupBox displayGroupBox      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Display:"      Enabled         =   False      Height          =   77      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   29      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   110      Underline       =   False      Visible         =   True      Width           =   105      Begin RadioButton select2D         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Traces"         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   0         InitialParent   =   "displayGroupBox"         Italic          =   False         Left            =   27         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   136         Underline       =   False         Value           =   True         Visible         =   True         Width           =   75      End      Begin RadioButton select2D         AutoDeactivate  =   True         Bold            =   False         Caption         =   "2D"         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   1         InitialParent   =   "displayGroupBox"         Italic          =   False         Left            =   27         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   160         Underline       =   False         Value           =   False         Visible         =   True         Width           =   50      End   End   Begin ScrollBar temporalScrollBar      AcceptFocus     =   False      AutoDeactivate  =   True      Enabled         =   False      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   291      LineStep        =   1      LiveScroll      =   False      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Maximum         =   100      Minimum         =   0      PageStep        =   2000      Scope           =   0      TabIndex        =   30      TabPanelIndex   =   0      TabStop         =   True      Top             =   612      Value           =   0      Visible         =   False      Width           =   698   End   Begin TextField subjectIDfield      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   79      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   31      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   246      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   160   End   Begin Label captionText      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   6      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   32      TabPanelIndex   =   0      Text            =   "Subject ID:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   10.0      TextUnit        =   0      Top             =   246      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   53   End   Begin Timer modifierKeyTimer      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   4      LockedInPosition=   False      Mode            =   2      Period          =   250      Scope           =   0      TabPanelIndex   =   0      Top             =   405      Width           =   32   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  if self.sessionObject <> nil then self.sessionObject.syncViewMenusWithSettings		End Sub	#tag EndEvent	#tag Event		Function CancelClose(appQuitting as Boolean) As Boolean		  // check if there is unsaved data		  		  dim alert as new messageDialog		  dim btn as messageDialogButton		  dim setsWithData as integer = 0		  		  if self.sessionObject <> nil then setsWithData = self.sessionObject.howManySetsHaveUnSavedSaccadeData		  		  select case setsWithData		    		  case 0  // there is no data to be saved, so tidy up and leave..		    self.breakCircularReferences		    return false		    		  case 1		    alert.Message = "There is one set with measurements that need to be saved."		    		  case else		    alert.Message = "There are " + str(setsWithData) + " sets with measurements that need to be saved."		    		  end select		  		  alert.actionButton.caption = "Don't Close"		  alert.alternateActionButton.caption = "Close and Lose the Data"		  alert.alternateActionButton.visible = true		  btn = alert.showModalWithin(self)		  		  select case btn		    		  case alert.actionButton  // don't close		    return true		    		  case alert.alternateActionButton  // continue closing		    self.breakCircularReferences		    return false		    		  end select		  		End Function	#tag EndEvent	#tag Event		Sub EnableMenuItems()		  // Each window holds an instance of an iViewSession.  If the property is nil, then the fileImportData menuitem is enabled.		  // Once a session has been created, the menuitem is disabled for that window.		  		  FileClose.enabled = true		  FilePageSetup.enabled = true		  		  if self.sessionObject = nil then		    FileImportData.enabled = true		    FileImportOriginaliViewData.enabled = true		    FileImportMoVEData.enabled = true		    FileReattachMeasurementsFromFile.enabled = false		    FileExportSaccadeData.enabled = false		    FileSaveVelocityProfiles.enabled = false		    FileExportTracesWithMeasurements.enabled = false		    FileExportTracesWithMeasurements.checked = false		    FileCollateMeasurementsInSingleFile.enabled = false		    FileCollateMeasurementsInSingleFile.checked = false		    FileSaveUpdatedMeasurements.enabled = false		    FilePrint.enabled = false		    AnalysisMenu.enabled = false		    ViewMenu.enabled = false		    'AnalysisCalibrationMode.enabled = false		    'AnalysisChangeFactorOffset.enabled = false		    'AnalysisEditMeasurements.enabled = false		    		  else		    FileImportData.enabled = false		    FileImportOriginaliViewData.enabled = false		    FileImportMoVEData.enabled = false		    FileExportTracesWithMeasurements.checked = sessionObject.exportTracesWithMeasurements		    FileCollateMeasurementsInSingleFile.enabled = true		    FileCollateMeasurementsInSingleFile.checked = sessionObject.collateMeasurements		    		    AnalysisMenu.enabled = true		    AnalysisCalibrationMode.enabled = true		    AnalysisChangeFactorOffset.enabled = true		    		    ViewMenu.enabled = true		    if self.sessionObject.sourceOfData = "iView" then		      ViewMoVE.enabled = false		      ViewiView.enabled = true		      iViewHorizontalposition.enabled = true		      iViewHorizontalVelocity.enabled = true		      iViewVerticalposition.enabled = true		      iViewVerticalVelocity.enabled = true		    else		      ViewiView.enabled = false		      ViewMoVE.enabled = true		      MoVEAcceleration.enabled = true		      MoVEVelocity.enabled = true		      MoVEXPosition.enabled = true		      MoVEYPosition.enabled = true		      MoVEZPosition.enabled = true		    end if		    		    		    if self.sessionObject.selectedSetHasSaccadeData then		      FileExportSaccadeData.enabled = true		      AnalysisEditMeasurements.enabled = true		      FileReattachMeasurementsFromFile.enabled = false		      FileSaveVelocityProfiles.enabled = true		      FileSaveUpdatedMeasurements.enabled = true		    else		      FileExportSaccadeData.enabled = false		      AnalysisEditMeasurements.enabled = false		      if self.sessionObject.dataImportCompleted then FileReattachMeasurementsFromFile.enabled = true		      if sessionObject.collateMeasurements = TRUE then		        FileSaveVelocityProfiles.enabled = TRUE		        FileSaveUpdatedMeasurements.enabled = TRUE		      else		        FileSaveVelocityProfiles.enabled = false		        FileSaveUpdatedMeasurements.enabled = false		      end if		    end if		    		    if self.sessionObject.selectedSetHasUnsavedSaccadeData then		      FileSaveMeasurements.enabled = true		    else		      FileSaveMeasurements.enabled = false		    end if		    		    FilePrint.enabled = true		    		  end if		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  // respond to keypresses		  		  'gLog "keydown event of chartWindow class"		  		  if self.sessionObject <> nil then  // don't want to accept key presses prior to a session object being created (ie before a file has been imported)		    		    select case key		      		    case "0"  // select all cursors		      self.sessionObject.selectCursors 0		      		    case "1"  // select cursor 1		      self.sessionObject.selectCursors 1		      		    case "2"  // select cursor 2		      self.sessionObject.selectCursors 2		      		    case "3"  // select cursor 3		      self.sessionObject.selectCursors 3		      		    case "4"  // select cursor 4		      self.sessionObject.selectCursors 4		      		    case "5"  // select cursor 5		      self.sessionObject.selectCursors 5		      		    case "6"  // select cursor 6		      self.sessionObject.selectCursors 6		      		    case "8"  // zap higher cursors back to the location of the third		      self.sessionObject.compressHigherCursors		      		    case "9"  // zap all cursors back to the location of the first		      self.sessionObject.compressCursors		      		    case "a"  // automatically detect the next saccade		      self.sessionObject.detectNextSaccade		      		    case "h"  // export movement trace to text file		      self.sessionObject.exportTraces		      		    case "o"  // toggle cursors on or off		      ViewShowcursors.checked = not ViewShowcursors.checked		      self.sessionObject.showCursors ViewShowcursors.checked		      		    case "b"  // go to set before this one		      if setSelectorPopup.listIndex > 0 then self.sessionObject.selectSet(setSelectorPopup.listIndex-1)		      		    case "n"  // go to next set		      if setSelectorPopup.listIndex < setSelectorPopup.listCount - 1 then self.sessionObject.selectSet(setSelectorPopup.listIndex+1)		      		    case "x"  // X marks the spot: highlight the selected stimulus		      self.sessionObject.displayHighlightedStimulus		      		    case "y"  // enter post hoc calibration mode		      self.sessionObject.postHocCalibration		      		    case chr(13)  // return key		      'gLog " KEY PRESSED: return"		      '#if not targetWin32 then  // don't respond to the return key on Win XP as there seems to be an erroneous return keydown		      // generated when dismissing the measurement window.  Use enter instead on Windows.		      self.sessionObject.measure		      '#endif		      		    case chr(3) // enter key		      'gLog " KEY PRESSED: enter"		      self.sessionObject.measure		      		    case chr(28)  // left arrow		      self.respondToArrowKey true		      		    case chr(29)  // right arrow		      self.respondToArrowKey false		      		    case chr(30)  // up arrow		      self.sessionObject.changeYAxisScale false		      		    case chr(31)  // down arrow		      self.sessionObject.changeYAxisScale true		      		    case ","  // < key		      if zoomTimeAxisSlider.value < zoomTimeAxisSlider.Maximum then		        zoomTimeAxisSlider.value = zoomTimeAxisSlider.value +1		      end if		      		    case "." // > key		      if zoomTimeAxisSlider.value >1 then		        zoomTimeAxisSlider.value = zoomTimeAxisSlider.value -1		      end if		      		    case "e"  // edit saccade data		      self.sessionObject.editSaccadeData		      		    case "f"  // manual recalibration		      self.manualCalWindow.showModalWithin(self)		      		    case else		      		      return false  // keypress was unhandled		      		    end select		    		    self.setFocus		    return true  // stop any further actions happening in response to this key		    		  else		    		    return false  // keypress was unhandled		    		  end if		  		  		exception err		  gHandleException err, "keydown event of chartWindow class."		End Function	#tag EndEvent	#tag Event		Sub MouseMove(X As Integer, Y As Integer)		  // draw some crosshairs when the mouse moves over the plots		  		  if self.sessionObject <> nil then  // only try this if there is actually data		    		    // the chart needs to know the coordinates relative to the canvas, not the window.		    X = X - self.chartCanvas.Left		    Y = Y - self.chartCanvas.top		    		    if X >= 0 and X < self.chartCanvas.Width then		      if Y >= 0 and Y < self.chartCanvas.height then		        self.sessionObject.drawCrossHair(X, Y)		      end if		    end if		    		  end if		End Sub	#tag EndEvent	#tag Event		Sub Open()		  		  'gLog "ChartWindow open event"		  		  // need to add code to stagger multiple windows but a low priority as there won't often be multiple windows.		  self.parametersBeingSetInCode = true		  self.top = screen(0).availableTop + kWindowTitleBarHeight		  self.left = screen(0).availableLeft		  self.width = screen(0).availableWidth		  self.height = screen(0).availableHeight - kWindowTitleBarHeight		  self.parametersBeingSetInCode = false		  		  // clear some staticTexts (it is useful for them to contain default text in the IDE so that they are easily visible).		  self.cursorText(0).text = ""		  self.cursorText(1).text = ""		  self.cursorText(2).text = ""		  self.manualCalWindow = new manualRecalibrationWindow(self)  // instantiate a hidden cal. window property, with a link back to this window.		  		End Sub	#tag EndEvent	#tag Event		Sub Resized()		  if not self.parametersBeingSetInCode then		    if sessionObject <> nil then		      sessionObject.makeSelectedSetDirty		      sessionObject.displaySet		    end if		  end if		End Sub	#tag EndEvent	#tag MenuHandler		Function AnalysisCalibrationMode() As Boolean Handles AnalysisCalibrationMode.Action			sessionObject.postHocCalibration					End Function	#tag EndMenuHandler	#tag MenuHandler		Function AnalysisChangeFactorOffset() As Boolean Handles AnalysisChangeFactorOffset.Action			self.manualCalWindow.showModalWithin(self)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function AnalysisEditMeasurements() As Boolean Handles AnalysisEditMeasurements.Action			self.sessionObject.editSaccadeData		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			self.close		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileCollateMeasurementsInSingleFile() As Boolean Handles FileCollateMeasurementsInSingleFile.Action			sessionObject.collateMeasurements = not sessionObject.collateMeasurements		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileExportSaccadeData() As Boolean Handles FileExportSaccadeData.Action			sessionObject.saveSaccadeData		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileExportTracesWithMeasurements() As Boolean Handles FileExportTracesWithMeasurements.Action			sessionObject.exportTracesWithMeasurements = not sessionObject.exportTracesWithMeasurements					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileImportdata() As Boolean Handles FileImportdata.Action			// respond to a menu item request to import new iView text data.						dim tempDataParser as iViewParserThread						tempDataParser = new iViewParserThread(self)			'tempDataParser.priority = 10  // speeds up the importing process (default value is 5).  No longer needed as importing happens in the background and a high value makes the UI unresponsive.						// Start the dataParser, giving the parser a reference to this window so that the open dialog and progress window can display within it as sheet windows:			tempDataParser.run						// the thread will run and then send the imported session to the addSession method of this window						exception err			gHandleException err, "FileImportData handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileImportMoVEData() As Boolean Handles FileImportMoVEData.Action			// respond to a menu item request to import new MoVElab HDF5 data						dim tempDataParser as HDF5parserThread						tempDataParser = new HDF5parserThread(self)			'tempDataParser.priority = 10  // speeds up the importing process (default value is 5).  No longer needed as importing happens in the background and a high value makes the UI unresponsive.						// Start the dataParser, giving the parser a reference to this window so that the open dialog and progress window can display within it as sheet windows:			tempDataParser.run						// the thread will run and then send the imported session to the addSession method of this window						exception err			gHandleException err, "HDF5parserThread handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileImportOriginaliViewData() As Boolean Handles FileImportOriginaliViewData.Action			// respond to a menu item request to import new iView text data.						dim tempDataParser as oldiViewParserThread						tempDataParser = new oldiViewParserThread(self)			'tempDataParser.priority = 10  // speeds up the importing process (default value is 5).  No longer needed as importing happens in the background and a high value makes the UI unresponsive.						// Start the dataParser, giving the parser a reference to this window so that the open dialog and progress window can display within it as sheet windows:			tempDataParser.run						// the thread will run and then send the imported session to the addSession method of this window						exception err			gHandleException err, "FileImportOriginaliViewData handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilePageSetup() As Boolean Handles FilePageSetup.Action			dim pageSetup as PrinterSetup						pageSetup = new PrinterSetup			if mPrinterSettings <> "" then pageSetup.SetupString = mPrinterSettings						if pageSetup.PageSetupDialog(self) then			mPrinterSettings = pageSetup.SetupString			end If								End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilePrint() As Boolean Handles FilePrint.Action			// recalculate the display and send it to the printer:						self.sessionObject.displaySet(TRUE)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileReattachMeasurementsFromFile() As Boolean Handles FileReattachMeasurementsFromFile.Action			sessionObject.reattachMeasurements		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSaveMeasurements() As Boolean Handles FileSaveMeasurements.Action			sessionObject.saveSaccadeData		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSaveUpdatedMeasurements() As Boolean Handles FileSaveUpdatedMeasurements.Action			// ReDo all the existing measurements in each set. This allows data to be updated when, for example, we want to add a new dependent variable to existing measurements			// or if there was a bug in previous measurements, filtering was incorrect, etc.						sessionObject.measureREDO					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSaveVelocityProfiles() As Boolean Handles FileSaveVelocityProfiles.Action			sessionObject.exportProfiles		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilterButterworth() As Boolean Handles FilterButterworth.Action						app.mouseCursor = system.cursors.Wait			self.sessionObject.filter "Butterworth"			// set the filter menuitems to the correct state			filterButterworth.checked = true			filterNone.checked = false			filterTriangular.checked = false						app.mouseCursor = system.cursors.standardPointer									exception err			gHandleException err, "FilterButterworth handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilterNone() As Boolean Handles FilterNone.Action						app.mouseCursor = system.cursors.Wait			self.sessionObject.filter "None"			// set the filter menuitems to the correct state			filterNone.checked = true			filterTriangular.checked = false			filterButterworth.checked = false									app.mouseCursor = system.cursors.standardPointer									exception err			gHandleException err, "FilterNone handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilterTriangular() As Boolean Handles FilterTriangular.Action						app.mouseCursor = system.cursors.Wait			self.sessionObject.filter "Triangular"			// set the filter menuitems to the correct state			filterTriangular.checked = true			filterButterworth.checked = false			filterNone.checked = false			app.mouseCursor = system.cursors.standardPointer						exception err			gHandleException err, "FilterTriangular handler of chartWindow class."		End Function	#tag EndMenuHandler	#tag MenuHandler		Function iViewEuclideanVelocity() As Boolean Handles iViewEuclideanVelocity.Action			dim thisMenu as menuItem						thisMenu = iViewEuclideanVelocity						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("v", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function iViewHorizontalposition() As Boolean Handles iViewHorizontalposition.Action			dim thisMenu as menuItem						thisMenu = iViewHorizontalposition						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("x", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function iViewHorizontalVelocity() As Boolean Handles iViewHorizontalVelocity.Action			dim thisMenu as menuItem						thisMenu = iViewHorizontalVelocity						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("vx", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function iViewVerticalposition() As Boolean Handles iViewVerticalposition.Action			dim thisMenu as menuItem						thisMenu = iViewVerticalposition						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("y", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function iViewVerticalVelocity() As Boolean Handles iViewVerticalVelocity.Action			dim thisMenu as menuItem						thisMenu = iViewVerticalVelocity						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("vy", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MoVEAcceleration() As Boolean Handles MoVEAcceleration.Action			dim thisMenu as menuItem						thisMenu = MoVEAcceleration						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("ax", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MoVEVelocity() As Boolean Handles MoVEVelocity.Action			dim thisMenu as menuItem						thisMenu = MoVEVelocity						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("vx", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MoVEXPosition() As Boolean Handles MoVEXPosition.Action			dim thisMenu as menuItem						thisMenu = MoVEXPosition						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("x", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MoVEYPosition() As Boolean Handles MoVEYPosition.Action			dim thisMenu as menuItem						thisMenu = MoVEYPosition						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("y", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MoVEZPosition() As Boolean Handles MoVEZPosition.Action			dim thisMenu as menuItem						thisMenu = MoVEZPosition						thisMenu.checked = not thisMenu.checked			self.sessionObject.displayGraphComponent("z", thisMenu.checked)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function ViewShowcursors() As Boolean Handles ViewShowcursors.Action			ViewShowCursors.checked = not ViewShowcursors.checked			self.sessionObject.showCursors ViewShowcursors.checked					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub addSession(session as iViewSession)		  // this method is called by the data parsing thread to add the imported session object		  		  		  'gLog "addSession method of chartWindow"		  		  // add a persistent instance of the data to the window		  sessionObject = session		  // send a circular reference to this window to the session property		  sessionObject.parentWindow = self		  		  // title the window and set other strings		  self.title = sessionObject.fileName		  self.subjectIDfield.text = sessionObject.subject_id		  self.groupField.text = sessionObject.subject_group		  self.sexField.text = sessionObject.subject_sex		  		  // disable the 2D vs line trace radio buttons if not iView data:		  if sessionObject.sourceOfData <> "iView" then		    self.select2D(0).visible = false		    self.select2D(1).visible = false		  end if		  		  		exception err		  gHandleException err, "addSession method of chartWindow class."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub breakCircularReferences()		  // break circular references to allow memory to be freed up when a window is closed.		  // a cascade of these messages is initiated when a window is closed.		  		  if self.sessionObject <> nil then		    self.sessionObject.breakCircularReferences  // cascades to iViewSet, etc		    self.sessionObject = nil		  end if		  		  if self.manualCalWindow <> nil then		    self.manualCalWindow.breakCircularReferences		    self.manualCalWindow = nil		  end if		  		exception err		  gHandleException err, "breakCircularReferences method of of chartWindow class."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Destructor()		  'gLog "ChartWindow destructor"		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub displayCursorData(stats as dictionary)		  // takes a dictionary of cursor values and associated keys and displays them to the user.		  		  dim i, upperLimit as integer		  dim keyString, valueString, key, value, padding as string		  dim whiteSpace as string = "                    "  // 20 spaces		  		  upperLimit = stats.count - 1  // this number is a true count, not a uBound		  		  // the stuff below was for a monospaced font.  Will need to come up with something better		  for i = 0 to upperLimit		    key = stats.key(i).stringValue		    value = stats.value(key)		    		    key = left(key, len(key)-1)  // trim the last character of each key, as it is just there to allow unique values and shouldn't be displayed (messy, I know)		    if key <> "" then key = key + ":"  // add a separating colon, but only if it is not a blank line		    		    // for values without a minus sign, add a leading space to keep things pretty:		    if left(value, 1) <> "-" then value = " " + value		    keyString = keyString + key + EndOfLine		    valueString = valueString + value + EndOfLine		    		  next		  		  self.cursorText(0).text = keyString		  self.cursorText(1).text = valueString		  		  		exception err		  gHandleException err, "displayCursorData method of chartWindow."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub displayProgressInfo(info as string)		  // takes some text and displays it to the user.		  		  self.cursorText(3).text = "Status: " + info		  		exception err		  gHandleException err, "displayProgressInfo method of chartWindow."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub displayTrialInfo(stats as dictionary)		  // takes a dictionary of trial info values and associated keys and displays them to the user.		  		  dim i, upperLimit as integer		  dim displayString, key, value as string		  dim whiteSpace as string = "                    "  // 20 spaces		  		  upperLimit = stats.count - 1  // this number is a true count, not a uBound		  		  for i = 0 to upperLimit		    key = stats.key(i).stringValue		    value = stats.value(key)		    // adds some white space to each term so that the colons are aligned:		    displayString = displayString + key + " : " + value + EndOfLine		    		  next		  		  self.cursorText(2).text = displayString		  		exception err		  gHandleException err, "displayTrialInfo method of chartWindow."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub enableAllControls(show as boolean)		  dim i, upperLimit as integer		  		  upperLimit = self.controlCount - 1		  for i = 0 to upperLimit		    rectControl(self.control(i)).enabled = show  // need to cast to rectcontrol as control doesn't have an enabled property		  next		  		  if self.setSelectorPopup.ListCount = 1 then self.setSelectorPopup.enabled = false  // only enable the button if there is another set available to choose.		  		exception err		  gHandleException err, "enableAllControls method of chartWindow."		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub respondToArrowKey(leftward as boolean)		  // make large jumps if control key held down, small ones if not.		  // Currently only set up for responding to horizontal arrows (ie movement of data and cursors, but not changing y axis scaling.)		  //		  		  		  if ViewShowcursors.enabled then  // if the cursors are turned on then		    		    if keyboard.asyncControlKey then		      self.sessionObject.moveCursors leftward, 20  // move the cursors only, with large jumps (1/15th of the data range)		      return		    end if		    		    if keyboard.asyncAltKey then  // move the cursors and the data		      self.sessionObject.moveAlongTimeAxis leftward, 0.5  // move the data and the cursors, by 1/2 of the data range		      return		    end if		    		    if keyboard.asyncShiftKey then  // move the cursors only, at greater than normal speed (ie 1/60th of the range)		      self.sessionObject.moveCursors leftward, 100		    else  // no modifier key is pushed, so move the cursors only, with a single sample jump		      self.sessionObject.moveCursors leftward, 1		    end if		    		  else  // the cursors are off and only the data should move		    		    if keyboard.asyncAltKey then		      self.sessionObject.moveAlongTimeAxis leftward, 0.5  // move the data by 1/2 of the data range		    else		      self.sessionObject.moveAlongTimeAxis leftward, 1.0 // move the data range so that the end becomes the beginning.		    end if		    		  end if		  		  		exception err		  gHandleException err, "respondToArrowKey method of chartWindow."		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub turnProgressWheelOn(onOff as boolean)		  self.progressWheel.visible = onOff  // visible also = animated.		  		exception err		  gHandleException err, "turnProgressWheelOn method of chartWindow."		End Sub	#tag EndMethod	#tag Property, Flags = &h0		manualCalWindow As manualRecalibrationWindow	#tag EndProperty	#tag Property, Flags = &h0		mPrinterSettings As string	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			This property is set to true when GUI elements are having their values set in code (eg moving a slider).  Checking for this flag			allows us to prevent undesired drawing because changing a slider state for example may set start a cascade of events that are not wanted.		#tag EndNote		parametersBeingSetInCode As boolean = false	#tag EndProperty	#tag Property, Flags = &h0		sessionObject As iViewSession	#tag EndProperty	#tag Constant, Name = kWindowTitleBarHeight, Type = Double, Dynamic = False, Default = \"22", Scope = Public		#Tag Instance, Platform = Mac OS, Language = Default, Definition  = \"22"		#Tag Instance, Platform = Windows, Language = Default, Definition  = \"50"	#tag EndConstant#tag EndWindowCode#tag Events setSelectorPopup	#tag Event		Sub Change()		  // tell the session instance which set of data to display		  		  if not self.parametersBeingSetInCode then		    // NB must use the listIndex as the displayed value may be duplicated if a given trial was run more than once		    // i.e. the listed values are based on the index value from the HDF file for that trial.  We can't assume that all trials		    // occur in order or are not duplicated.  Also, those index values are 1-based.  Duplicate set numbers can also occur in iView recordings.		    self.sessionObject.selectSet me.listIndex		    self.setFocus		    me.refresh(false)		  end if		End Sub	#tag EndEvent	#tag Event		Sub GotFocus()		  'self.chartCanvas.setFocus		  'me.refresh		End Sub	#tag EndEvent#tag EndEvents#tag Events zoomTimeAxisSlider	#tag Event		Sub ValueChanged()		  // tell the session instance to change the zoom level factor		  if not self.parametersBeingSetInCode then self.sessionObject.zoomTimeAxis me.value		  self.setFocus		  me.refresh(false)		  		  		  		End Sub	#tag EndEvent	#tag Event		Sub GotFocus()		  self.chartCanvas.setFocus		  'me.refresh		End Sub	#tag EndEvent#tag EndEvents#tag Events TestTypePopUp	#tag Event		Sub Change()		  if not self.parametersBeingSetInCode then		    self.sessionObject.setTestType me.text		    self.setFocus		  end if		End Sub	#tag EndEvent	#tag Event		Sub GotFocus()		  'self.chartCanvas.setFocus		  'me.refresh		End Sub	#tag EndEvent#tag EndEvents#tag Events groupField	#tag Event		Sub LostFocus()		  if not self.parametersBeingSetInCode then self.sessionObject.subject_group = me.text		  'self.chartCanvas.setFocus		End Sub	#tag EndEvent#tag EndEvents#tag Events sexField	#tag Event		Sub LostFocus()		  if not self.parametersBeingSetInCode then self.sessionObject.subject_sex = me.text		End Sub	#tag EndEvent#tag EndEvents#tag Events SelectAnalysis	#tag Event		Sub Action(index as Integer)		  // toggle between analysing the iView data as 2D or as component line traces		  		  if index = 0 then		    self.sessionObject.analyse2D = FALSE		  else		    self.sessionObject.analyse2D = TRUE		  end if		  		exception err		  gHandleException err, "Action method of selectAnalysis radio button of chartWindow class."		End Sub	#tag EndEvent#tag EndEvents#tag Events select2D	#tag Event		Sub Action(index as Integer)		  // toggle between displaying the iView data as 2D or as component line traces		  		  if index = 0 then		    self.sessionObject.display2D = FALSE		  else		    self.sessionObject.display2D = TRUE		  end if		  		exception err		  gHandleException err, "Action method of select2D radio button of chartWindow class."		End Sub	#tag EndEvent#tag EndEvents#tag Events subjectIDfield	#tag Event		Sub LostFocus()		  if not self.parametersBeingSetInCode then self.sessionObject.subject_id = me.text		  'self.chartCanvas.setFocus		End Sub	#tag EndEvent#tag EndEvents#tag Events modifierKeyTimer	#tag Event		Sub Action()		  // This timer checks whether the modifer keys SHIFT or CONTROL are pressed (as they don't generate keydown events for the window		  // to handle). If so, we update the cursorDisplayData to reflect which stimulus would be chosen and hence what the latency would be.		  // There are nested if/thens here so that we don't keep needlessly sending update messages. The data is updated only after either key		  // is first pushed and again after it is first released.		  		  static shiftKeyAlreadyDetected as boolean = FALSE		  static ctrlKeyAlreadyDetected as boolean = FALSE		  		  if keyboard.asyncShiftKey then		    		    if shiftKeyAlreadyDetected then		      RETURN		    else		      shiftKeyAlreadyDetected = TRUE		      if self.sessionObject <> nil then self.sessionObject.updateCursorDisplayData		      RETURN  // ensures shift key takes precedence over the ctrl key so we don't get any conflicting battles over which is pushed.		    end if		    		  else		    if shiftKeyAlreadyDetected then		      if self.sessionObject <> nil then self.sessionObject.updateCursorDisplayData		    end if		    shiftKeyAlreadyDetected = FALSE		    		  end if		  		  		  if keyboard.asyncControlKey then		    		    if ctrlKeyAlreadyDetected then		      RETURN		    else		      ctrlKeyAlreadyDetected = TRUE		      if self.sessionObject <> nil then self.sessionObject.updateCursorDisplayData		    end if		    		  else		    if ctrlKeyAlreadyDetected then		      if self.sessionObject <> nil then self.sessionObject.updateCursorDisplayData		    end if		    		    ctrlKeyAlreadyDetected = FALSE		    		  end if		  		  		exception err		  gHandleException err, "Action event of ModifierKeyTimer of ChartWindow."		End Sub	#tag EndEvent#tag EndEvents#tag ViewBehavior	#tag ViewProperty		Name="BackColor"		Visible=true		Group="Appearance"		InitialValue="&hFFFFFF"		Type="Color"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Backdrop"		Visible=true		Group="Appearance"		Type="Picture"		EditorType="Picture"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="CloseButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Composite"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Frame"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Document"			"1 - Movable Modal"			"2 - Modal Dialog"			"3 - Floating Window"			"4 - Plain Box"			"5 - Shadowed Box"			"6 - Rounded Window"			"7 - Global Floating Window"			"8 - Sheet Window"			"9 - Metal Window"			"10 - Drawer Window"			"11 - Modeless Dialog"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="FullScreen"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="HasBackColor"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Height"		Visible=true		Group="Position"		InitialValue="400"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="ImplicitInstance"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Interfaces"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="LiveResize"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MacProcID"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxHeight"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaximizeButton"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxWidth"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBar"		Visible=true		Group="Appearance"		Type="MenuBar"		EditorType="MenuBar"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBarVisible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinHeight"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinimizeButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinWidth"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="mPrinterSettings"		Group="Behavior"		Type="string"		EditorType="MultiLineEditor"	#tag EndViewProperty	#tag ViewProperty		Name="Name"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="parametersBeingSetInCode"		Group="Behavior"		InitialValue="false"		Type="boolean"	#tag EndViewProperty	#tag ViewProperty		Name="Placement"		Visible=true		Group="Position"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Default"			"1 - Parent Window"			"2 - Main Screen"			"3 - Parent Window Screen"			"4 - Stagger"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="Resizeable"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Super"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Title"		Visible=true		Group="Appearance"		InitialValue="Untitled"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Visible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Width"		Visible=true		Group="Position"		InitialValue="600"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty#tag EndViewBehavior