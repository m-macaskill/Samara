#tag WindowBegin Window ManualRecalibrationWindow   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   False   Compatibility   =   ""   Composite       =   False   Frame           =   1   FullScreen      =   False   HasBackColor    =   False   Height          =   233   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   4   Resizeable      =   False   Title           =   "Progress"   Visible         =   False   Width           =   424   Begin Label labelText      AutoDeactivate  =   True      BehaviorIndex   =   0      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   False      Left            =   148      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Text            =   "X calibration factor:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   0.0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   134   End   Begin Label labelText      AutoDeactivate  =   True      BehaviorIndex   =   0      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   False      Left            =   148      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Text            =   "X offset:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   0.0      Top             =   53      Underline       =   False      Visible         =   True      Width           =   134   End   Begin SettingField calibrationField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BehaviorIndex   =   1      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   0      InitialParent   =   ""      Italic          =   False      Left            =   294      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   "False"      Password        =   False      ReadOnly        =   False      Scope           =   "0"      ScrollbarHorizontal=   "False"      ScrollbarVertical=   "True"      Styled          =   "False"      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "1.0"      TextFont        =   "System"      TextSize        =   0.0      Top             =   21      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   110   End   Begin SettingField calibrationField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BehaviorIndex   =   1      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   1      InitialParent   =   ""      Italic          =   False      Left            =   294      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   "False"      Password        =   False      ReadOnly        =   False      Scope           =   "0"      ScrollbarHorizontal=   "False"      ScrollbarVertical=   "True"      Styled          =   "False"      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   "0.0"      TextFont        =   "System"      TextSize        =   0.0      Top             =   53      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   110   End   Begin PushButton OKButton      AutoDeactivate  =   True      BehaviorIndex   =   2      Bold            =   False      Cancel          =   False      Caption         =   "Re-calibrate"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   264      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   193      Underline       =   False      Visible         =   True      Width           =   140   End   Begin PushButton cancelButton      AutoDeactivate  =   True      BehaviorIndex   =   3      Bold            =   False      Cancel          =   False      Caption         =   "Cancel"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   "0"      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   193      Underline       =   False      Visible         =   True      Width           =   80   End   Begin PushButton resetButton      AutoDeactivate  =   True      BehaviorIndex   =   4      Bold            =   False      Cancel          =   False      Caption         =   "Restore raw data"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   112      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   "0"      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   193      Underline       =   False      Visible         =   True      Width           =   140   End   Begin SettingField calibrationField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BehaviorIndex   =   1      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   False      Left            =   294      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   "False"      Password        =   False      ReadOnly        =   False      Scope           =   "0"      ScrollbarHorizontal=   "False"      ScrollbarVertical=   "True"      Styled          =   "False"      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   "1.0"      TextFont        =   "System"      TextSize        =   0.0      Top             =   87      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   110   End   Begin SettingField calibrationField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BehaviorIndex   =   1      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   False      Left            =   294      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Mask            =   ""      Multiline       =   "False"      Password        =   False      ReadOnly        =   False      Scope           =   "0"      ScrollbarHorizontal=   "False"      ScrollbarVertical=   "True"      Styled          =   "False"      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   "0.0"      TextFont        =   "System"      TextSize        =   0.0      Top             =   121      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   110   End   Begin Label labelText      AutoDeactivate  =   True      BehaviorIndex   =   0      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   2      InitialParent   =   ""      Italic          =   False      Left            =   148      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Y calibration factor:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   0.0      Top             =   87      Underline       =   False      Visible         =   True      Width           =   134   End   Begin Label labelText      AutoDeactivate  =   True      BehaviorIndex   =   0      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   3      InitialParent   =   ""      Italic          =   False      Left            =   148      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   "0"      TabIndex        =   11      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Y offset:"      TextAlign       =   2      TextFont        =   "System"      TextSize        =   0.0      Top             =   121      Underline       =   False      Visible         =   True      Width           =   134   End   Begin Checkbox applyToAllSetsCheckBox      AutoDeactivate  =   True      BehaviorIndex   =   5      Bold            =   False      Caption         =   "Apply to all sets"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   266      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   "0"      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      Top             =   161      Underline       =   False      Value           =   False      Visible         =   True      Width           =   136   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  self.calibrationField(0).selStart = 0		  self.calibrationField(0).selLength = len(self.calibrationField(0).text)		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub breakCircularReferences()		  // break circular references to allow memory to be freed up when a chartWindow is closed.		  // a cascade of these messages is initiated when a window is closed.		  		  mParentWindow = nil		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor(parentWindow as chartWindow)		  mParentWindow = parentWindow		End Sub	#tag EndMethod	#tag Property, Flags = &h1		Protected mParentWindow As chartwindow	#tag EndProperty#tag EndWindowCode#tag Events OKButton	#tag Event		Sub Action()		  // tell the data to recalibrate with the supplied values		  dim factor(1), offset(1) as double		  		  factor(0) = cDbl(self.calibrationField(0).text)		  offset(0) = cDbl(self.calibrationField(1).text)		  factor(1) = cDbl(self.calibrationField(2).text)		  offset(1) = cDbl(self.calibrationField(3).text)		  		  app.mouseCursor = system.cursors.Wait		  mParentWindow.sessionObject.manualRecalibration FALSE, factor(), offset(), self.applyToAllSetsCheckBox.value, "horizontal"		  mParentWindow.sessionObject.manualRecalibration FALSE, factor(), offset(), self.applyToAllSetsCheckBox.value, "vertical"		  		  app.mouseCursor = system.cursors.standardPointer		  		  #if TargetWin32 then  // this was added to fix a bug in Win XP where the dialog sometimes couldn't be dismissed.		    if self.applyToAllSetsCheckBox.value then msgBox "Push OK."		  #endif		  		  self.hide		  		End Sub	#tag EndEvent#tag EndEvents#tag Events cancelButton	#tag Event		Sub Action()		  // don't do anything		  'self.close  // this was added to fix a bug in Win XP where the dialog sometimes couldn't be dismissed.		  self.hide		  		End Sub	#tag EndEvent#tag EndEvents#tag Events resetButton	#tag Event		Sub Action()		  // tell the data to reset itself to its original values (ie with no calibration equation applied).		  dim factor(1), offset(1) as double		  		  		  // these values will be ignored: they are just placeholders, because the reset boolean is true		  factor(0) = 1		  factor(1) = 1		  offset(0) = 0		  offset(1) = 0		  		  self.OKButton.default = FALSE		  app.mouseCursor = system.cursors.Wait		  		  mParentWindow.sessionObject.manualRecalibration TRUE, factor(), offset(), self.applyToAllSetsCheckBox.value, "horizontal"		  mParentWindow.sessionObject.manualRecalibration TRUE, factor(), offset(), self.applyToAllSetsCheckBox.value, "vertical"		  		  self.calibrationField(0).text = "1.0"		  self.calibrationField(1).text = "0.0"		  self.calibrationField(2).text = "1.0"		  self.calibrationField(3).text = "0.0"		  		  app.mouseCursor = system.cursors.standardPointer		  'self.OKButton.default = TRUE		  		  		  #if TargetWin32 then  // this was added to fix a bug in Win XP where the dialog sometimes couldn't be dismissed.		    if self.applyToAllSetsCheckBox.value then msgBox "Push OK."		  #endif		  		  self.hide		  		End Sub	#tag EndEvent#tag EndEvents#tag ViewBehavior	#tag ViewProperty		Name="BackColor"		Visible=true		Group="Appearance"		InitialValue="&hFFFFFF"		Type="Color"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Backdrop"		Visible=true		Group="Appearance"		Type="Picture"		EditorType="Picture"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="CloseButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Composite"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Frame"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Document"			"1 - Movable Modal"			"2 - Modal Dialog"			"3 - Floating Window"			"4 - Plain Box"			"5 - Shadowed Box"			"6 - Rounded Window"			"7 - Global Floating Window"			"8 - Sheet Window"			"9 - Metal Window"			"10 - Drawer Window"			"11 - Modeless Dialog"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="FullScreen"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="HasBackColor"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Height"		Visible=true		Group="Position"		InitialValue="400"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="ImplicitInstance"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Interfaces"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="LiveResize"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MacProcID"		Visible=true		Group="Appearance"		InitialValue="0"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxHeight"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaximizeButton"		Visible=true		Group="Appearance"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MaxWidth"		Visible=true		Group="Position"		InitialValue="32000"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBar"		Visible=true		Group="Appearance"		Type="MenuBar"		EditorType="MenuBar"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBarVisible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinHeight"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinimizeButton"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="MinWidth"		Visible=true		Group="Position"		InitialValue="64"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Name"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Placement"		Visible=true		Group="Position"		InitialValue="0"		Type="Integer"		EditorType="Enum"		InheritedFrom="Window"		#tag EnumValues			"0 - Default"			"1 - Parent Window"			"2 - Main Screen"			"3 - Parent Window Screen"			"4 - Stagger"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="Resizeable"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Super"		Visible=true		Group="ID"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Title"		Visible=true		Group="Appearance"		InitialValue="Untitled"		Type="String"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Visible"		Visible=true		Group="Appearance"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"		InheritedFrom="Window"	#tag EndViewProperty	#tag ViewProperty		Name="Width"		Visible=true		Group="Position"		InitialValue="600"		Type="Integer"		InheritedFrom="Window"	#tag EndViewProperty#tag EndViewBehavior