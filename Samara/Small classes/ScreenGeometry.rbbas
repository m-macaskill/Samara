#tag ClassClass ScreenGeometry	#tag Method, Flags = &h0		Function convertAngleToPixels(angle as double, horizontal as boolean = TRUE) As double		  // reverse calculates a location from degrees to pixels for 2D plotting.		  // Needs to know if the location is a horizontal or vertical one.		  		  		  if horizontal then		    return distance * tan(angle/radToDeg)/horizMmPerPixel + horizScreenPixelCentre		  else		    return vertScreenPixelCentre - distance * tan(angle/radToDeg)/vertMmPerPixel		  end if		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function convertPixelsToAngle(pixelPosn as double, horizontal as boolean = TRUE) As double		  // converts a location from pixels to degrees.		  // Needs to know if the location is a horizontal or vertical one.		  		  		  if horizontal then		    return atan((pixelPosn - horizScreenPixelCentre) * horizMmPerPixel / distance) * radToDeg		  else		    return atan((pixelPosn - vertScreenPixelCentre) * vertMmPerPixel / distance) * radToDeg * -1 // invert to take care of differing iView and Experimenter origins.		  end if		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub setupValues()		  horizMmPerPixel = width/pixelWidth		  vertMmPerPixel = height/pixelHeight		  horizScreenPixelCentre = pixelWidth/2		  vertScreenPixelCentre = pixelHeight/2		End Sub	#tag EndMethod	#tag Property, Flags = &h0		#tag Note			Eye-to-screen distance in mm		#tag EndNote		distance As double	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			Physical height of the display in mm		#tag EndNote		height As double	#tag EndProperty	#tag Property, Flags = &h1		Protected horizMmPerPixel As double	#tag EndProperty	#tag Property, Flags = &h1		Protected horizScreenPixelCentre As Integer	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			Number of pixels vertically on the screen		#tag EndNote		pixelHeight As integer	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			Number of pixels across the screen		#tag EndNote		pixelWidth As integer	#tag EndProperty	#tag Property, Flags = &h1		#tag Note			mRadToDeg = 180/gPi		#tag EndNote		Protected radToDeg As double = 57.29577951308	#tag EndProperty	#tag Property, Flags = &h1		Protected vertMmPerPixel As double	#tag EndProperty	#tag Property, Flags = &h1		Protected vertScreenPixelCentre As Integer	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			Physical width of the display in mm		#tag EndNote		width As double	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="distance"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="height"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="2147483648"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="pixelHeight"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="pixelWidth"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="width"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass